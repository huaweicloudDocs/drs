# 数据加工<a name="drs_03_0035"></a>

数据复制服务支持对同步的对象进行加工，即可以为选择的对象添加规则，目前DDM-\>DWS、DDM-\>Oracle只支持为源库表的列添加同步时间戳，MySQL-\>MySQL、Oracle-\>MySQL和Oracle-\>TaurusDB只支持数据过滤。

>![](public_sys-resources/icon-note.gif) **说明：**   
>目前仅DDM-\>DWS、DDM-\>Oracle、MySQL-\>MySQL、Oracle-\>MySQL和Oracle-\>TaurusDB支持数据加工。  

## 添加同步时间戳<a name="section193171813442"></a>

1.  在“数据加工“页面，“源库对象选择区“中选择需要加工的表对象。
2.  单击“数据加工区“区域，单击“添加规则“，填写需要添加的列名、类型、选项等信息。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >-   需要添加规则的列为表中已有列，且不能为主键。  
    >-   仅支持使用数据类型为时间戳类型（TIMESTAMP）的列作为规则列。  

3.  检查无误后，单击“下一步“，进入下一步操作。

## 数据过滤<a name="section12677102715213"></a>

数据过滤规则添加后，在源库执行更新操作的处理原则，以数据一致为首要目标。即：

-   更新前不符合过滤条件，更新后符合。继续同步，在目标库执行相同的更新操作，如果匹配不到数据，根据冲突处理策略处理。此时，冲突处理策略为覆盖，否则，数据有不一致风险。
-   更新前符合过滤条件，更新后不符合。继续同步，在目标库执行相同的更新操作。

1.  在“数据加工“页面，“加工大类“选择“数据过滤“。

    **图 1**  数据加工<a name="fig16892185312305"></a>  
    ![](figures/数据加工.png "数据加工")

2.  在“对象选择“区域选择需要加工的表对象。
3.  在过滤条件区域，填写过滤条件（只需填写SQL语句的WHERE之后部分，例如id=1）后，单击“校验“。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >-   每张表仅支持添加一个校验规则。  
    >-   Oracle为源库的数据过滤每次最多支持20000张表，MySQL为源库的数据过滤每次最多支持10000张表。  
    >-   过滤条件不支持使用某种数据库引擎特有的packege、函数、变量、常量等写法，须使用通用SQL标准。  

4.  校验通过后，单击“生成加工规则“，即可在加工规则表格中看到该规则。
5.  检查无误后，单击“下一步“，进入下一步操作。

## 查看数据加工<a name="section19636153994612"></a>

1.  在“数据同步管理”页面任务列表中，选择需要查看数据加工的任务，单击任务名称。
2.  选择“数据加工“页签，查看数据加工记录。单击右上角的![](figures/drs_icon-2-19.png)，可刷新数据。

