# 多活灾备<a name="drs_01_0305"></a>

## 数据库类型<a name="section28212518163245"></a>

数据复制服务目前支持MySQL数据库类型的灾备管理。

**表 1**  数据库类型

<a name="table18151296913"></a>
<table><thead align="left"><tr id="row381520299912"><th class="cellrowborder" valign="top" width="28.400000000000002%" id="mcps1.2.6.1.1"><p id="p28158293911"><a name="p28158293911"></a><a name="p28158293911"></a><strong id="b168151229495"><a name="b168151229495"></a><a name="b168151229495"></a>数据流向</strong></p>
</th>
<th class="cellrowborder" valign="top" width="16.800000000000004%" id="mcps1.2.6.1.2"><p id="p1776195917559"><a name="p1776195917559"></a><a name="p1776195917559"></a><strong id="b6273111065611"><a name="b6273111065611"></a><a name="b6273111065611"></a>灾备方向</strong></p>
</th>
<th class="cellrowborder" valign="top" width="21.450000000000003%" id="mcps1.2.6.1.3"><p id="p118155291094"><a name="p118155291094"></a><a name="p118155291094"></a><strong id="b581562918916"><a name="b581562918916"></a><a name="b581562918916"></a>业务数据库</strong></p>
</th>
<th class="cellrowborder" valign="top" width="17.290000000000003%" id="mcps1.2.6.1.4"><p id="p198155297920"><a name="p198155297920"></a><a name="p198155297920"></a><strong id="b1481582918919"><a name="b1481582918919"></a><a name="b1481582918919"></a>灾备数据库</strong></p>
</th>
<th class="cellrowborder" valign="top" width="16.060000000000002%" id="mcps1.2.6.1.5"><p id="p1564515232003"><a name="p1564515232003"></a><a name="p1564515232003"></a><strong id="b1461593714015"><a name="b1461593714015"></a><a name="b1461593714015"></a>灾备数据库实例类型</strong></p>
</th>
</tr>
</thead>
<tbody><tr id="row98155291395"><td class="cellrowborder" valign="top" width="28.400000000000002%" headers="mcps1.2.6.1.1 "><p id="p108151629091"><a name="p108151629091"></a><a name="p108151629091"></a>MySQL数据库-&gt;RDS for MySQL实例</p>
</td>
<td class="cellrowborder" valign="top" width="16.800000000000004%" headers="mcps1.2.6.1.2 "><p id="p1576185916550"><a name="p1576185916550"></a><a name="p1576185916550"></a>正向灾备</p>
</td>
<td class="cellrowborder" valign="top" width="21.450000000000003%" headers="mcps1.2.6.1.3 "><a name="ul14815142918916"></a><a name="ul14815142918916"></a><ul id="ul14815142918916"><li>本地自建数据库</li><li>ECS自建数据库</li><li>其他云上数据库</li><li>RDS for MySQL实例</li></ul>
</td>
<td class="cellrowborder" valign="top" width="17.290000000000003%" headers="mcps1.2.6.1.4 "><p id="p58158291997"><a name="p58158291997"></a><a name="p58158291997"></a>RDS for MySQL实例</p>
</td>
<td class="cellrowborder" valign="top" width="16.060000000000002%" headers="mcps1.2.6.1.5 "><a name="ul1448917478010"></a><a name="ul1448917478010"></a><ul id="ul1448917478010"><li>单机实例</li><li>主备实例</li></ul>
</td>
</tr>
<tr id="row1745116123118"><td class="cellrowborder" valign="top" width="28.400000000000002%" headers="mcps1.2.6.1.1 "><p id="p1045119114315"><a name="p1045119114315"></a><a name="p1045119114315"></a>RDS for MySQL实例-&gt;MySQL数据库</p>
</td>
<td class="cellrowborder" valign="top" width="16.800000000000004%" headers="mcps1.2.6.1.2 "><p id="p18452914315"><a name="p18452914315"></a><a name="p18452914315"></a>反向灾备</p>
</td>
<td class="cellrowborder" valign="top" width="21.450000000000003%" headers="mcps1.2.6.1.3 "><p id="p545212113110"><a name="p545212113110"></a><a name="p545212113110"></a>RDS for MySQL实例</p>
</td>
<td class="cellrowborder" valign="top" width="17.290000000000003%" headers="mcps1.2.6.1.4 "><a name="ul167144383114"></a><a name="ul167144383114"></a><ul id="ul167144383114"><li>本地自建数据库</li><li>ECS自建数据库</li><li>其他云上数据库</li><li>RDS for MySQL实例</li></ul>
</td>
<td class="cellrowborder" valign="top" width="16.060000000000002%" headers="mcps1.2.6.1.5 "><a name="ul2237923324"></a><a name="ul2237923324"></a><ul id="ul2237923324"><li>单机实例</li><li>主备实例</li></ul>
</td>
</tr>
</tbody>
</table>

## 数据库版本<a name="section14715316216"></a>

**表 2**  数据库版本信息

<a name="table1229562020531"></a>
<table><thead align="left"><tr id="row32951520125317"><th class="cellrowborder" valign="top" width="27.522752275227525%" id="mcps1.2.5.1.1"><p id="p8295162025313"><a name="p8295162025313"></a><a name="p8295162025313"></a><strong id="b18688195010532"><a name="b18688195010532"></a><a name="b18688195010532"></a>数据流向</strong></p>
</th>
<th class="cellrowborder" valign="top" width="18.471847184718474%" id="mcps1.2.5.1.2"><p id="p4497163625720"><a name="p4497163625720"></a><a name="p4497163625720"></a><strong id="b11350145345714"><a name="b11350145345714"></a><a name="b11350145345714"></a>灾备方向</strong></p>
</th>
<th class="cellrowborder" valign="top" width="27.872787278727877%" id="mcps1.2.5.1.3"><p id="p12956204532"><a name="p12956204532"></a><a name="p12956204532"></a><strong id="b168865014532"><a name="b168865014532"></a><a name="b168865014532"></a>业务数据库版本</strong></p>
</th>
<th class="cellrowborder" valign="top" width="26.13261326132613%" id="mcps1.2.5.1.4"><p id="p1329582019534"><a name="p1329582019534"></a><a name="p1329582019534"></a><strong id="b1668845075319"><a name="b1668845075319"></a><a name="b1668845075319"></a>灾备数据库版本</strong></p>
</th>
</tr>
</thead>
<tbody><tr id="row1929502018534"><td class="cellrowborder" valign="top" width="27.522752275227525%" headers="mcps1.2.5.1.1 "><p id="p12142855135310"><a name="p12142855135310"></a><a name="p12142855135310"></a>MySQL数据库-&gt;RDS for MySQL实例</p>
</td>
<td class="cellrowborder" valign="top" width="18.471847184718474%" headers="mcps1.2.5.1.2 "><p id="p16497163615711"><a name="p16497163615711"></a><a name="p16497163615711"></a>正向灾备</p>
</td>
<td class="cellrowborder" valign="top" width="27.872787278727877%" headers="mcps1.2.5.1.3 "><a name="zh-cn_topic_0095989426_ul29364242145033"></a><a name="zh-cn_topic_0095989426_ul29364242145033"></a><ul id="zh-cn_topic_0095989426_ul29364242145033"><li>MySQL 5.6.x</li><li>MySQL 5.7.x</li></ul>
</td>
<td class="cellrowborder" valign="top" width="26.13261326132613%" headers="mcps1.2.5.1.4 "><a name="ul10811332115516"></a><a name="ul10811332115516"></a><ul id="ul10811332115516"><li>MySQL 5.6.x</li><li>MySQL 5.7.x</li></ul>
</td>
</tr>
<tr id="row1162803218321"><td class="cellrowborder" valign="top" width="27.522752275227525%" headers="mcps1.2.5.1.1 "><p id="p116289324322"><a name="p116289324322"></a><a name="p116289324322"></a>RDS for MySQL实例-&gt;MySQL数据库</p>
</td>
<td class="cellrowborder" valign="top" width="18.471847184718474%" headers="mcps1.2.5.1.2 "><p id="p562833203214"><a name="p562833203214"></a><a name="p562833203214"></a>反向灾备</p>
</td>
<td class="cellrowborder" valign="top" width="27.872787278727877%" headers="mcps1.2.5.1.3 "><a name="ul81501119123312"></a><a name="ul81501119123312"></a><ul id="ul81501119123312"><li>MySQL 5.6.x</li><li>MySQL 5.7.x</li></ul>
</td>
<td class="cellrowborder" valign="top" width="26.13261326132613%" headers="mcps1.2.5.1.4 "><a name="ul162357224339"></a><a name="ul162357224339"></a><ul id="ul162357224339"><li>MySQL 5.6.x</li><li>MySQL 5.7.x</li></ul>
</td>
</tr>
</tbody>
</table>

## 网络准备<a name="section7123911282"></a>

数据复制服务支持通过多种方式的网络进行数据灾备，包括：VPN网络、专线网络和公网网络，在正式灾备之前请参考[表3](#table81301656181615)进行网络设置。

**表 3**  网络类型

<a name="table81301656181615"></a>
<table><thead align="left"><tr id="row1513013564163"><th class="cellrowborder" valign="top" width="18.5%" id="mcps1.2.4.1.1"><p id="p1513085671615"><a name="p1513085671615"></a><a name="p1513085671615"></a><strong id="b55681318171719"><a name="b55681318171719"></a><a name="b55681318171719"></a>网络类型</strong></p>
</th>
<th class="cellrowborder" valign="top" width="24.560000000000002%" id="mcps1.2.4.1.2"><p id="p1933549191311"><a name="p1933549191311"></a><a name="p1933549191311"></a><strong id="b1775015515143"><a name="b1775015515143"></a><a name="b1775015515143"></a>使用场景</strong></p>
</th>
<th class="cellrowborder" valign="top" width="56.940000000000005%" id="mcps1.2.4.1.3"><p id="p813011568169"><a name="p813011568169"></a><a name="p813011568169"></a><strong id="b072818014315"><a name="b072818014315"></a><a name="b072818014315"></a>准备工作</strong></p>
</th>
</tr>
</thead>
<tbody><tr id="row513075691614"><td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.4.1.1 "><p id="p8130135619163"><a name="p8130135619163"></a><a name="p8130135619163"></a>VPN网络</p>
</td>
<td class="cellrowborder" valign="top" width="24.560000000000002%" headers="mcps1.2.4.1.2 "><p id="p7783193731416"><a name="p7783193731416"></a><a name="p7783193731416"></a>适合通过VPN网络，实现其他云下自建数据库与云上数据库同步、或云上跨区域的数据库之间的同步。</p>
</td>
<td class="cellrowborder" valign="top" width="56.940000000000005%" headers="mcps1.2.4.1.3 "><p id="p1838162621913"><a name="p1838162621913"></a><a name="p1838162621913"></a>用户需要确保本地数据中心和目标数据库所在VPC的VPN网络建立连接，确保VPN网络可正常访问的前提下，再进行数据灾备。</p>
<p id="p22705289526"><a name="p22705289526"></a><a name="p22705289526"></a>VPN相关操作，请参见《<a href="https://support.huaweicloud.com/qs-vpn/zh-cn_topic_0133627788.html" target="_blank" rel="noopener noreferrer">虚拟专用网络快速入门</a>》。</p>
</td>
</tr>
<tr id="row4969916115418"><td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.4.1.1 "><p id="p49704167548"><a name="p49704167548"></a><a name="p49704167548"></a>专线网络</p>
</td>
<td class="cellrowborder" valign="top" width="24.560000000000002%" headers="mcps1.2.4.1.2 "><p id="p137847121412"><a name="p137847121412"></a><a name="p137847121412"></a>适合通过专线网络，实现其他云下自建数据库与云上数据库同步、或云上跨区域的数据库之间的同步。</p>
</td>
<td class="cellrowborder" valign="top" width="56.940000000000005%" headers="mcps1.2.4.1.3 "><p id="p1797010167540"><a name="p1797010167540"></a><a name="p1797010167540"></a>用户需要通过专线网络建立云与数据中心的专线连接。</p>
<p id="p169183035219"><a name="p169183035219"></a><a name="p169183035219"></a>云专线相关操作，请参见《<a href="https://support.huaweicloud.com/qs-dc/zh-cn_topic_0145790541.html" target="_blank" rel="noopener noreferrer">云专线快速入门</a>》。</p>
</td>
</tr>
<tr id="row111301056141618"><td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.4.1.1 "><p id="p1213015661613"><a name="p1213015661613"></a><a name="p1213015661613"></a>公网网络</p>
</td>
<td class="cellrowborder" valign="top" width="24.560000000000002%" headers="mcps1.2.4.1.2 "><p id="p13331449101313"><a name="p13331449101313"></a><a name="p13331449101313"></a>适合将其他云下或其他平台的数据库同步到目标数据库。</p>
</td>
<td class="cellrowborder" valign="top" width="56.940000000000005%" headers="mcps1.2.4.1.3 "><p id="p97175511282"><a name="p97175511282"></a><a name="p97175511282"></a>为了确保源数据库和目标数据库之间的网络互通，源数据库端和目标数据库端分别需要进行如下设置：</p>
<a name="ol971712552814"></a><a name="ol971712552814"></a><ol id="ol971712552814"><li>开启公网访问<p id="p157173518281"><a name="p157173518281"></a><a name="p157173518281"></a>源数据库端实例需要根据具体的场景，由用户端开启公网访问。</p>
</li><li>设置安全组规则<a name="ul14881615102616"></a><a name="ul14881615102616"></a><ul id="ul14881615102616"><li>源数据库需要将DRS灾备实例的弹性公网IP添加到其网络入口白名单内，使源数据库与DRS灾备实例可以连通。</li><li>由于目标数据库和DRS灾备实例处于同一个VPC内，默认网络是连通的，不需要单独设置安全组。</li></ul>
<div class="note" id="note271719582817"><a name="note271719582817"></a><a name="note271719582817"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="ul1044841115276"></a><a name="ul1044841115276"></a><ul id="ul1044841115276"><li>DRS灾备实例创建成功后，可在“源库及目标库”页面获取DRS灾备实例的弹性公网IP。</li><li>在选择公网网络进行数据灾备同步时，如果没有开启SSL安全连接加密灾备链路的功能，请确保待灾备的数据为非机密数据，再进行数据灾备。</li></ul>
</div></div>
</li></ol>
</td>
</tr>
</tbody>
</table>

