# MongoDB数据库<a name="drs_02_0014"></a>

介绍MongoDB数据库在线迁移的使用限制。在正式使用数据复制服务之前，请先阅读以确保源数据库和目标数据库已经满足以下使用条件。

## 副本集<a name="section2411057114117"></a>

数据复制服务对于副本集数据库的迁移有如下限制。

-   支持如下版本：
    -   MongoDB3.2.x
    -   MongoDB3.4.x

-   目前MongoDB数据库支持副本集实例的全量和增量迁移。
-   支持副本集到集群的全量迁移，迁移之前需要在目标数据库的集群先进行分片配置，再启动迁移。
-   目前副本集不支持函数对象的迁移。
-   目标数据库实例的运行状态必须正常。
-   在增量迁移阶段，为了保持数据一致性，不允许对正在迁移中的目标数据库进行修改操作\(包括但不限于DDL、DML操作\)。
-   迁移过程中，不允许添加、修改或删除源数据库所有用户的用户名、密码、权限和源数据库端口号。
-   MongoDB副本集实例状态必须正常，要存在主节点。
-   不支持源数据库的库名中包含单引号。
-   源数据库需要填写主节点的相关信息，包括IP，帐号和密码。
-   连接源数据库的用户权限需要对admin和local数据库有read权限。
-   测试连接开始之后，源数据库不能发生主备切换。
-   启动迁移任务之后，目标数据库不能发生主备切换。
-   目前不支持从高版本数据库到低版本数据库的迁移。
-   目标数据库实例必须有足够的磁盘空间。
-   同一个文档数据库只能同时成为一个迁移任务的目标数据库。

## 集群<a name="section480818110438"></a>

数据复制服务对于集群数据库的迁移有如下限制。

-   支持如下版本：
    -   MongoDB3.2.x
    -   MongoDB3.4.x


-   目前MongoDB数据库仅支持集群实例的全量迁移。
-   集群到集群的全量迁移，如果源数据库的集群没有开启分片，则需要保证目标数据库主shard节点的磁盘空间大于源数据库数据大小。
-   迁移过程中，不允许添加、修改或删除源数据库所有用户的用户名、密码、权限和源数据库端口号。
-   目前集群不支持函数对象的迁移。
-   目标数据库实例的运行状态必须正常。
-   不支持源数据库的库名中包含单引号。
-   连接源数据库的用户权限需要对admin和config数据库有read权限。
-   目前不支持从高版本数据库到低版本数据库的迁移。
-   目标数据库实例必须有足够的磁盘空间。
-   同一个文档数据库只能同时成为一个迁移任务的目标数据库。

